---
layout: docs
title: Defining the Entity · Docs · KBEngine
tab: docs
docsitem: documentation-entitydef
---

Defining the Entity
====================

What needs to be defined Entity:

	Stored in the database.
	Ability to facilitate remote access.
	Need to manage and monitor its engines, such as: AOI, Trap, etc...
	When a disaster recovery server can automatically recover.


What needs to be defined Entity-attribute:

	Stored in the database.
	Entities are after migration data is still valid (only cellapp Migrating Entities, such as teleport-scene).
	When a disaster recovery server can automatically recover.

What needs to be defined Entity-method:

	Ability to facilitate remote access.


You need to perform the following steps:
-----------------------------------------

1. Registration of Entity

	Path definition file : `demo/scripts/entities.xml`

	Example:

		<root>
			<Account/>
			<Avatar/>
			<Spaces/>
			<Space/>
			<Monster/>
			<NPC/>
			<Gate/>
		</root>


2. Def file to create a directory in `demo/scripts/entity_defs`

	For example: Account.def


3. You may also need to define some properties and methods

	1. In the `demo/scripts/` directory has three subdirectories (base, cell, client), you can add Account.py needed.

	2. Not every entity needs to create three parts(client, base, cell), press need to select.


-----------------------------------------


Def file format
-----------------------------------------

	<root>
		<Properties>
			// Property Name
			<accountName>
				// Property type
				<Type>			UNICODE				</Type>

				// (optional)
				// Property of a custom protocol ID，If the client does not use the KBE supporting SDK development，
				// The client needs to develop with KBE docking protocol, You can define the property ID to facilitate identification,
				// The c++ protocol uses a uint16 to describe，If you do not define a ID，
				// engine will use its own rules generated by the protocol ID, The ID must be unique in all the def file.
				<Utype>			1000				</Utype>

				// Property Scopes (reference: Propertie Scopes section)
				<Flags>			BASE				</Flags>

				// (optional)
				// Is stored in the database
				<Persistent>		true				</Persistent>

				// (optional)
				// The maximum length is stored in the database
				<DatabaseLength> 	100				</DatabaseLength>

				// (optional)
				// Default value 
				<Default>		kbengine			</Default>

				// (optional)
				// DB index, Support for UNIQUE and INDEX
				<Index>			UNIQUE				</Index>
			</accountName>
			
			...
			...
		</Properties>

		<ClientMethods>
			// Remote Method name of the Client exposure
			<onReqAvatarList>
				// remote method args type
				<Arg>			AVATAR_INFOS_LIST		</Arg>
				// (optional)
				<Utype>			1001				</Utype>
			</onReqAvatarList>

			...
			...
		</ClientMethods>

		<BaseMethods>
			// Remote Method name of the Baseapp exposure
			<reqAvatarList> 
				// cell exposure method must exist this tag
				<Exposed/>

				// (optional)
				<Utype>			1002				</Utype>
			</reqAvatarList>
			
			...
			...
		</BaseMethods>

		<CellMethods>
			// Remote Method name of the Cellapp exposure
			<hello>
				// (optional)
				<Utype>			1003				</Utype>
			</hello>
		</CellMethods>

	</root>

For example: Call the base method in the client to get a list of roles (Account.py):

	 self.base.reqAvatarList()


-----------------------------------------


Propertie Scopes
-----------------------------------------

	[type]			[client]		[base]			[cell]
	BASE			-			*			-
	BASE_AND_CLIENT		*			*			-
	CELL_PRIVATE		-			-			*(cell)
	CELL_PUBLIC		-			-			*(cells)
	CELL_PUBLIC_AND_OWN	*(client)		-			*(cells)
	ALL_CLIENTS		*(clients)		-			*(cells)
	OWN_CLIENT		*(client)		-			*(cell)
	OTHER_CLIENTS		*(other clients)	-			*(cells)



-----------------------------------------------

download(example): 
[rpgdemo_project.tar]



[rpgdemo_project.tar]: {{ site.baseurl }}/assets/other/rpgdemo_project.tar